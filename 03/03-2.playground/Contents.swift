import UIKit

var input = """
....#............#.###...#.#.#.
.#.#....##.........#.....##.#..
.#..#.#...####.##..#......#..##
......#...#...#.......#........
........#...###..#.#....#....#.
..##.....#.....#.#.........#.#.
.##.......#.#.#...#..#...##...#
...##.....#....##....#...###.#.
..#...#......##.#.##.....#.#..#
.#....#.###.........#..........
.#.#..##.....###.....###....#.#
....###....#......#...#......##
......##...#.##.........#.#..#.
##.#....##...#..##....#.#..#.##
.#...#..#.....#.#.......#...#..
..........#..###.###......##..#
..#.##.#..#......#.......###.#.
...#...#.#.#..#...#.#..........
#........#..#..#.#....#.##..###
#...#.....#..####.........####.
.....###..........#.#...##...#.
.....#...#..#.......#....##.#..
...........#..##.....#...#..#..
......##..#........#...........
#.#..#.#.#..#.....#....#.....#.
..#....##....##...#.....#......
.#.#....#..#.#......#..###...#.
.......#...#.#....##..#..#..#..
.#.#.#.......#....#.#.#.......#
.#..........#.##.#...#..#.#.##.
..#.#..........#.#....##.#.##..
###..#..#.#...##.#.#..#........
##....#...#....#....#...#.#....
#...#.#....#.##..##...#.#......
......#...#.###......##....#...
.................#.###......#..
##..#....#....##...###.#.#..###
..#..........#..####..##..#...#
.#......#..#.#...........##.#..
.#..#......#...#.#.#..#.#.#.#.#
.#......###.....#.#.#......##..
#..........#.##...#...........#
..#....#.##....#.........#.....
.#..##....#...##.........#..#..
....##..#.###..#.#...#..###..#.
..#......#........#...#.#......
........#..#..#..#...#.##......
.##.#.#......#...#.........#...
#..###.#...#....###.##..###....
........##.............#....#..
...#...............#....#.#....
#..........#..#..#.#.....#...#.
.#.............#...#.......#..#
.#..#..#...#........##.........
.....#.#..#.#..#..##.........#.
..#..##...#....#.#...#.###..#..
#...........##.....#...#.##....
#.#.#.#........##......#...#.#.
......#..#.###.#...#.##.##....#
.#....#...#....#........#....#.
..#.#..........#..##.......#..#
.....#...##..#................#
.#...............##...#.##...##
#.####....##.....#.......#.##..
......#.##.#...##..###..#.#....
.#.##.#...##..#.......#.#..#...
#...#.##..........##..........#
#.###...#...#..#.....#.#.##..##
.##.....#....#...##.....##.....
...#........#..###.###...#.....
##..#....#.....#...#.#....#.#..
#....#....#.#..........#...#..#
...##..#......#..#..#..#..#....
.....##...#..####..##.........#
.....#..#.#...#..#....##..##...
..#.......##.#..#.##...#.#....#
.#..#.#...##..##....#..#......#
..##.##..##...###..#....#...#..
........##.......##...##.....##
.#....###...#..#..#..#.......#.
#.###............#....##.....#.
..........#...#...##..#...#....
..#......#.##.......#....##..##
..#..###.....#...#.......#.....
#.#...##.....#...#....#.......#
....##.##.#....#.....#.#....#..
...#....#.###............#..###
#..##..#.........##.....#.#...#
....#.......##......#....#...#.
....#..##.#..........#.........
....#...#.###.......#...#.#....
#..#..#...#.......##...#..#.##.
#.......#...##.##......#.......
##..##...##...#......#...#...##
..#...#.#.####.#...##.....##...
#...#..#..#...##......#.#..#..#
..##..##.#.#..#...####.....###.
.#........#..##.###...#.##.#...
........#..#...##......#.#....#
..#...###.......##..##..#....#.
.##...#.#..#.##.......##.###...
#....#.#.#........#....#..#.##.
....#.##.#.##..#.#####.....###.
#.#..#..#...#.#..#.......#.#...
....#...#....###...............
.###.#.....#.#.......###......#
##...#.#.###....##..#...##.....
...#.#..#.###.#.......#...#.#..
.#...#....#...#..####....###...
..#....##.....##.#.#.##....#...
#....#..##.......#...##.##....#
.##..#.......#..#....###.......
#.##.....##.#.........#......##
.####.#...#.....#..#...#.##..#.
....#...........#.....#........
.#............##...#.......#.#.
#....#.##........#....#.#..#..#
#....#.##....#...##...#..#..#..
...#..#.####.#....#............
....#......#.........#.........
#....##....###.....#......#.#..
...#..#....#........###..#...#.
..#.#........#.#.#.###..#.#.#..
.....###.....##.#....###.#.....
##.#....#....##...##.###.#.##..
.###.#..#.......##...#...##....
.#...###........#.......##.##..
#......####...#...##.#.######..
....##.............#..##.##...#
...........#..##.#...#.#.#...#.
###.......#.##..#....#...#....#
.........#.....#.#.#..##.#.....
#...##..#....#..#.............#
...#.......#.##.............#.#
.....#..#...##......####..#....
.#.#.#.....#...####..#...##...#
#...#.#..#..#.#..#.##..........
.....#.##..#.#.##..#.#.#....#.#
...##..#...#...#..#....#.......
........#.#..#...#...#.#...#...
##..#........#..#.....#......##
.........#..#...#......#......#
..#.#.#........##...#.##.....##
.###....##....#...#....#..#....
.#.............###...#..##..###
.##.##.##.......###.........#.#
..#..###...#...#....#..#.#..#.#
......#..#.#..#.....#.#........
......#...####...#.#.....#.....
.#...##.......#..#......#...#..
#..#...#.......###..#..#.#.#.#.
.....#.....###.##....#.#.##.#.#
#........#....##...#..#.##..#..
...#.#........##....#.#..###.#.
#...#...##.........#........###
##...#.##..##...#.....#.###.#..
#.###.#.#..#...........##..#...
........#.......#..#..#.###....
#........#....#......###.......
..#.###.######...#.###..#......
...#...######..#.....#....#.#..
..#.......#..#..#.........#...#
.#...#..##.##.........##.......
.........#.#.##.#..#....#.#...#
#.......#....#......#.....###.#
##..............#.###........#.
..#.##..#.##.....#...#.#.#..###
..#.#......#..#..##.#........#.
..#.....#...#.#...#...###..#.#.
.......#...........#..#..#.#.##
.......#...##..#.###...........
.#........#.###.#..#..#..#..#..
##.#.##....#..###..#.##.##...#.
.....#....##.#........#.#.#....
....##....#..#..#....##....#.#.
#.....##....#.....#.###.#....#.
.#.##.##..#..#...#...........##
...#..###..#.....##....#.......
...#..##..###.#..#..#.#........
......##..#.......#..##.....###
.#...##.#.#.#......#...#.#.#.##
....#.#....#...#........#...#..
....#.#......#.#.###.#.#.##.#..
#..#........###..#..#..#.....#.
...#....#...##...#........##.##
.....#..#..#.....#....#.#...#..
..#.###....#.#..##......#.##.#.
..####......#..#.#.#..#.#####..
.......##..#..###.#............
..###.#........#..........##.##
#.#.........#.##.#......#..#...
...#.....#.....##..#..##.##..#.
#.#.##....#.......###....##....
...##.#..#...##.#..#......#..#.
..##.........#.##.#####...#.#..
.#....#...#....#.#.....##...###
##.....#..####............###.#
......#...........#....#.......
.#......#.....##...........###.
#......##.......#.#.#..##.....#
...###.#.....##.#...#.#....#.#.
...###.......#...#.............
..#..#.#....#.#.###.#.#.##..##.
..##...#..#.#..##.#.##....##...
..#...........#..#....#....#...
#.##...........#..#.#..##.#.#..
...##...##................#..#.
.#...#.##......#.#......#.####.
#.##....#....#.........#....###
.....###........#.#.#.##...#.##
.....#....#.#....#.........#..#
..#...#.#.#.#...#...#...##.#..#
###.......#.....#.............#
#.####.#.......#.#.#.#..#.#....
#..#..#####......#....#..##....
...............#.....#.#....###
.###.....#...#.##..#.#..#.#####
#.##.....#......##.......##....
..........###.......#...#.#....
..#.#..#...##.....#........#.#.
........##.##....#####.#.#..##.
..##.#.#...#####..........#.#.#
#.........#......##...#.....#..
.##.#........#...#..##...#...#.
.......##..#...#.....#.##......
....#.#...##..##..#....##......
#........#..........##..####.#.
...###...#.#.###.#...#....#.#.#
.....##.#.....#........#.#....#
#.......#....#...##..#......#..
...#..........#.#.#...#.#.###.#
....##.....#.##..#.#.#.........
#.##..##..#....#.........#...#.
.###..........#...##.#..#......
.....####.............##...###.
.#..#....#..#...#..#...........
#..#..##..#...#.##..#.###.#...#
......#.#..###...#..#.....#..#.
##.##......#...#.#...#.........
....##.#.......#.#..##....#.#.#
#..##..#...###.#....##.........
.............#.#....#...##..#..
..#....#...#.....#.##.#..##..##
##.#..##.#..##.#.#.##.#...#.#..
.##.#..#.#........##.#...##....
#.........##....##..#......#...
.#.#.......##...#..#......###.#
........#.#.#.#......#....#..#.
...##..#...#...#.##..#....#.#..
...#.#.#.#.......#.......###..#
...#..##..#####.#.....##.#..#..
.......#.#.....#.....#...#...##
#...#...#......##.#....##......
#.....#.#.#.....#....#......#..
..#..#.##.#......##..#.#..#..##
####...#.....#....#.#..........
....#.....###...#...##......#..
.....#....#...#............#...
...#...#..##.........#...#...##
#.#..#.#...##.#.......#..#.#...
.#.....#...##.............#...#
.....#..##..#....#......#.##..#
....#...###.................#..
...###...#....#...#...#........
....#.##.#.......#..#..........
...#..#......#.#...###...#.#...
..#.#..#...#.......#.......#.#.
.#.#...#.#.##........#.........
...#..#...#....#.#.#.#.#..###..
.#..##......#.#.##..#.##....#..
#....#.......##.....#.#........
..###..#.#.#.......##....#.....
........#.#.#....##...##..#....
#....##.#....#...##..##...#....
...#..##.#.....#...#.....##....
.#.#..#..#...#....#..##.#....#.
##.#.##....#.....#....#....#.#.
.##......#............##...#...
#..##.#.####.#.#....#..#..#.#.#
#...##...#......##....###.....#
..#.##.....#....#....#......#..
.##.#...#.....#.#.#.#........##
.#..#....#.#...........#...#...
#.....#..#.....#.#.##.#.....#..
....#.....#..#.#....###........
.....###...........#.#..##.#.#.
....###....#.......###..#...#.#
.###.....#...##.#...##........#
..#..#.#..#...#.#...#.#..#...#.
#.####.......#....##.#..#.#..#.
....#.#.##.#..###.........##.#.
..#..#.#....#....#.##..........
..##.###..#.#..#.#......#....#.
.#..#.....##...#.#......##.#..#
#.#....#..#.#.#........#.###...
...#....##....##..###.###.#.#..
..#....#.....#....##.#.........
#.......#....#.........##..#...
.#..#...#.#..#.#....#.#........
...#..###...#.....#......##....
..#...........#.....#..........
....###.#...#......#...#..#....
.....#.##..#..#....#.......#..#
....##..#.#.#..............#.#.
.#.#..#..#.#......#...#.#......
....#.......#.##....##.#.#.#..#
............#.#.#.....##.......
........#...##.#..#......#...##
.........#...#...#....#...#.##.
..#.....#......#......#.....#..
#....#...##..#.#....#.#...#.###
.......#..#..#..#.#...#.....#.#
...#.#...#......##.....#..#....
...#.#.####..##.#..#...........
..##..##....#.....####...#....#
###.......#...##.#...#...#...#.
.##..#.....#..####......#....#.
#.....#..#..##..##...#..#..#...
.#....#.....#...####..####.....
..#....#...#......#........#.#.
##.#.......#..#.....#..##..##..
.#..#..#.#.#...#....##...#.##.#
##...#..#....#.........##......
"""

extension String {
    subscript(_ int: Int) -> Character {
        self[index(startIndex, offsetBy: int)]
    }
}

func hasTreeAt(tuple: (Int, Int)) -> Bool {
    lines[tuple.1][tuple.0 % lines[tuple.1].count] == "#"
}

func offsets(jumpX: Int, jumpY: Int) -> [(Int, Int)] {
    var x = 0
    return stride(from: 0, to: lines.count, by: jumpY)
        .map {
            let result = (x, $0)
            x = (x + jumpX) % lines[$0].count
            
            return result
        }
}

let lines = input.components(separatedBy: .newlines)

let trees = [(1, 1), (3, 1), (5, 1), (7, 1), (1, 2)]
    .map { offsets(jumpX: $0.0, jumpY: $0.1) }
    .map { $0.map { hasTreeAt(tuple: $0) } }
    .map { $0.reduce(0) { $0 + ($1 ? 1 : 0) } }
    .reduce(1) { $0 * $1 }

print(trees)

//[87, 169, 99, 98, 53]
//7560370818

